/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   entrypoint.c                                       :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: ebang <ebang@student.42.fr>                +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2022/12/09 20:49:04 by youngpar          #+#    #+#             */
/*   Updated: 2023/01/05 15:39:47 by ebang            ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "../inc/minish.h"

static void	banner2(void)
{
	printf("\033[0;91m"
		" \\__\\/  /~~/:/  /__/\\/:/~~  \\__\\/  |:|/:/  /__/\\/:/~~ "
		" \\  \\:\\ \\:\\_\\/ \\__\\/  \\:\\/:/ \\  \\:\\ \\:\\_\\/ "
		"\\  \\:\\    \\  \\:\\   \n");
	printf("\033[0;92m"
		"       /  /:/   \\  \\::/         |  |:/:/   \\  \\::/      "
		"\\  \\:\\_\\:\\        \\__\\::/   \\  \\:\\ \\:\\    \\  "
		"\\:\\    \\  \\:\\  \n");
	printf("\033[0;93m"
		"      /  /:/     \\  \\:\\         |__|::/     \\  \\:\\    "
		"   \\  \\:\\/:/        /  /:/     \\  \\:\\_\\/     \\  \\:"
		"\\    \\  \\:\\ \n");
	printf("\033[0;94m"
		"     /__/:/       \\__\\/         /__/:/       \\__\\/      "
		"  \\  \\::/        /__/:/       \\  \\:\\        \\  \\:\\ "
		"   \\  \\:\\\n");
	printf("\033[0;95m"
		"     \\__\\/                      \\__\\/                   "
		"   \\__\\/         \\__\\/         \\__\\/         \\__\\/ "
		"    \\__\\/\n");
}

static void	banner(void)
{
	printf("\033[0;31m"
		"      ___                        ___                        "
		"___           ___           ___           ___       ___ \n");
	printf("\033[0;32m"
		"     /  /\\           ___        /  /\\           ___       "
		" /  /\\         /  /\\         /  /\\         /  /\\     /  /\\\n");
	printf("\033[0;33m"
		"    /  /::|         /__/\\      /  /::|         /__/\\      "
		"/  /::\\       /  /:/        /  /::\\       /  /:/    /  /:/\n");
	printf("\033[0;34m"
		"   /  /:|:|         \\__\\:\\    /  /:|:|         \\__\\:\\ "
		"   /__/:/\\:\\     /  /:/        /  /:/\\:\\     /  /:/    /  /:/ \n");
	printf("\033[0;35m"
		"  /  /:/|:|__       /  /::\\  /  /:/|:|__       /  /::\\  _"
		"\\_ \\:\\ \\:\\   /  /::\\ ___   /  /::\\ \\:\\   /  /:/    /  /:/\n");
	printf("\033[0;36m"
		" /__/:/_|::::\\   __/  /:/\\/ /__/:/ |:| /\\   __/  /:/\\/ /"
		"__/\\ \\:\\ \\:\\ /__/:/\\:\\  /\\ /__/:/\\:\\ \\:\\ /__/:/ "
		"   /__/:/   \n");
	banner2();
	printf("\033[0;90m\n\t\t\t\t\t\t\t\t\t\t\t\t"
		"by. youngpar && ebang\n\033[0m");
}

static int	init(t_stat *stat, char **envp)
{
	stat->pgname = SHELL_NAME;
	stat->error = -1;
	stat->inFd = dup(STDIN_FILENO);
	stat->outFd = dup(STDOUT_FILENO);
	stat->env = deep_copy(envp);
	if (!(stat->env && stat->inFd != -1 && stat->outFd != -1))
		return (INIT_ERROR);
	return (0);
}

int	main(int argc, char **argv, char **envp)
{
	t_stat	stat;

	if (argc != 1)
		return (-1);
	stat.error = init(&stat, envp);
	if (stat.error != INIT_ERROR)
	{
		if (argv)
			banner();
		stat.error = minishell(&stat);
	}
	return (0);
}
